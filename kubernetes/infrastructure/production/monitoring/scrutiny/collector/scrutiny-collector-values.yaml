---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: scrutiny-collector
spec:
  values:
    controller:
      type: daemonset
    image:
      repository: ghcr.io/analogj/scrutiny
      tag: "v0.7.1-collector"
    env:
      COLLECTOR_API_ENDPOINT: "http://scrutiny-web:8080"
      COLLECTOR_CRON_SCHEDULE: "*/5 * * * *"
    securityContext:
      privileged: true
      capabilities:
        add:
          - SYS_RAWIO
    persistence:
      udev:
        enabled: true
        type: hostPath
        hostPath: /run/udev
        readOnly: true
    service:
      main:
        enabled: false
    ingress:
      main:
        enabled: false
    probes:
      liveness:
        enabled: false
      readiness:
        enabled: false
      startup:
        enabled: false
