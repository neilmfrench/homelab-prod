---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: crowdsec-cloudflare-bouncer
spec:
  values:
    image:
      repository: crowdsecurity/cloudflare-bouncer
      tag: "v0.2.1"
    service:
      main:
        ports:
          http:
            port: 2112
    persistence:
      config:
        enabled: true
        type: configMap
        name: cloudflare-bouncer-configmap
        mountPath: /etc/crowdsec/bouncers
        readOnly: true
      certs:
        enabled: true
        type: secret
        name: crowdsec-lapi-tls
        mountPath: /etc/ssl/certs
        readOnly: true
      cache:
        enabled: true
        mountPath: /var/lib/crowdsec/crowdsec-cloudflare-bouncer/cache
        existingClaim: crowdsec-cloudflare-bouncer-cache
